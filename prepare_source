# vim: ft=bash
#
# commit sha from https://github.com/cyberus-technology/libvirt/commits/gardenlinux/
LIBVIRT_COMMIT_SHA="8661ab92157f6f0abbdbae0b4072463f0b831e09"
version_increment="4"

git_src_commit "$LIBVIRT_COMMIT_SHA" https://github.com/cyberus-technology/libvirt.git

# debian specific things
crd=$(mktemp -d)
git clone --branch debian/11.10.0-2 --single-branch https://salsa.debian.org/libvirt-team/libvirt.git "$crd"
pushd "$crd"
git branch
cp -r debian "$dir/src/"
popd
rm -rf "$crd"

sed "s/SED_MARKER_FOR_COMMIT_SHA/$LIBVIRT_COMMIT_SHA/" <upstream_patches/meson.build.patch.tpl >upstream_patches/meson.build.patch

apply_patches
import_upstream_patches

version="11.10.0-2" # current debian base (do not change for rebuilds)
version_suffix="gl${version_increment}~sta1877"
message="Update to $version $version_suffix"
